# Лабораторная работа - Архитектура Сети

## Содержание:

- [Топология](#item_01)
- [Конвенции](#item_01.1)
- [Таблицы адресации](#item_02)
- [Цели](#item_03)
- [Часть 1: Разработка и документация адресного пространства для лаборатории.](#part_1)
- [Часть 2: Настроите ip адреса на каждом активном порту](#part_2)
- [Часть 3: Настроите каждый VPC в каждом офисе в своем VLAN.](#part_3)
- [Часть 4: Настроите VLAN/Loopbackup interface управления для сетевых устройств](#part_4)
- [Часть 5: Настроите сети офисов так, чтобы не возникало broadcast штормов, а использование линков было максимально оптимизировано](#part_5)
- [Часть 6: Используете IPv4. IPv6 по желанию](#part_6)


<a name="item_01"><h2>Топология</h2></a>



![topology](image_01_topology.png)


<a name="item_01.1"><h2>Конвенции</h2></a>

Тут я хотел бы обозначить несколько моментов. Во-первых, необходимо определиться с конвенциями. Ниже я описываю, какие именно конвенции я использую.

### Глобальные правила

**P2P**-линки используют **/31** (RFC 3021).

**Core-to-Distribution** - линки используют **/30** 

**Loopback-адреса** — /32 (ID роутеров).

**Кампусные VLAN** — /24.

Каждому автономному домену **(AS)** выделяется свой **/16**, разделённый на предсказуемые роли:

**…130.0/24** = Все меж-AS соединения

**…120.0/24** = Distribution - Access - линки

**…10.0/24 и …20.0/24** = VLAN 10 и 20 для пользователей

**…254.x/32** = loopback-адреса коммутаторов (необязательно)

**…255.x/32** = loopback-адреса маршрутизаторов


<a name="item_02"><h2>Таблицы Адресации</h2></a>

### Ниже приведены блоки адресов для каждой зоны

![topology](image_03_address_blocks.png)
###
###

### Loopback адреса для всех устройств. Первые два октета соответствуют зонам, третий актет - для маршрутизаторов = .255, для коммутаторов = .254

![topology](image_04_loopback.png)
###
###

### Inter-AS линки (10.250.130.0/16)

![topology](image_05_inter-as-links.png)


<a name="item_03"><h2>Цели</h2></a>

> ⚠️ **Важно:** Маршрутизация на данном этапе *не выполняется* и будет реализована на следующих стадиях проекта.

# **Целью данной лабораторной работы является**

1. **Разработка адресного пространства**  
   Формирование детализированной и масштабируемой схемы IP-адресации, включающей распределение сетей по зонам, назначение адресов интерфейсам маршрутизаторов, коммутаторов и виртуальных интерфейсов, а также определение служебных сетей для управления и тестирования.

2. **Создание VLAN**  
   Проектирование и внедрение виртуальных локальных сетей, обеспечивающих логическую сегментацию трафика, разделение доменов широковещания и организацию изолированных зон для различных групп устройств.

3. **Настройка LACP**  
   Конфигурация агрегации каналов по протоколу LACP (802.3ad) для увеличения пропускной способности и обеспечения отказоустойчивости соединений между коммутаторами.

4. **Конфигурация VRRP**  
   Реализация механизма резервирования шлюза по протоколу VRRP для обеспечения высокой доступности, автоматического переключения при отказе активного маршрутизатора и балансировки нагрузки между устройствами.

5. **Настройка VPC**  
   Создание виртуальных ПК (VPC), назначение им IP-адресов и шлюзов, интеграция их в соответствующие VLAN, а также подготовка окружения для проверки сетевых функций и протоколов.

6. **Проверка соединения между VPC и маршрутизаторами**  
   Тестирование доступности маршрутизаторов из различных VLAN, проверка правильности маршрутизации, ARP-разрешений, а также корректности работы интерфейсов и шлюзов.

7. **Проверка работы VRRP**  
   Проведение тестов отказоустойчивости: подтверждение правильного выбора master-устройства, наблюдение за переключением VRRP-групп при отключении активного маршрутизатора, анализ восстановления и возврата приоритетов.


<a name="part_1"><h2>Часть 1: Разработка и документация адресного пространства для лаборатории.</h2></a>


### Отчёт о системе адресации в лабораторной сети
## 1. Введение

Цель данного отчёта — описать логику и структуру системы адресации, применённой в лабораторной топологии, включающей:

- маршрутизаторы **R12–R28**
- коммутаторы **SW2–SW29**
- многоподсеточную архитектуру (**10.100.x.x, 10.204.x.x, 10.52.x.x, 10.128.x.x**)
- управляющую сеть **192.168.102.0/24** для всех устройств

Схема адресации выдерживает единые принципы и упрощает маршрутизацию, диагностику и масштабирование сети.

## 2. Общая концепция адресации

Сеть использует четыре основных адресных плана, каждый из которых относится к определённому логическому региону или зоне:

| Зона              | Пример адресов           | Использование                       |
| ----------------- | ------------------------ | ----------------------------------- |
| **10.100.x.x**    | R12, R13, R14, R15, R19, |               Valhalla              |
|                   | R20, SW2, SW3, SW4, SW5  |                                     |
| **10.101.x.x**    | R22                      |               IceLand               |
| **10.103.x.x**    | R21                      |               Frankia               |
| **10.204.x.x**    | R16, R17, R18, SW9, SW10 |               Helheim               |
|                   | R32                      |                                     |
| **10.52.x.x**     | R23, R24, R25, R26       |            Valkeria-Hall            |
| **10.127.x.x**    | R27                      |               Wessex                |
| **10.128.x.x**    | R28                      |               Midgard               |
| **192.168.102.x** | Все устройства           |    Управляющая (management) сеть    |


## 3. Адресация в управляющей сети (Management Network)

Все устройства имеют интерфейс (**e1/3**) в сети:

**192.168.102.0/24**


Каждому устройству присвоен адрес в диапазоне 192.168.102.100–129, где номер устройства соответствует последнему октету адреса.

Примеры:

- **R12 → 192.168.102.112**
- **R13 → 192.168.102.113**
- **R14 → 192.168.102.114**
- **SW9 → 192.168.102.109**
- **SW29 → 192.168.102.129**

Назначение:

- управление оборудованием (SSH, SNMP)
- мониторинг
- изоляция от пользовательских и маршрутизируемых VLAN

Такой подход обеспечивает стабильный доступ администратора вне зависимости от состояния основных маршрутов.

## 4. Адресация Loopback-интерфейсов

Каждый маршрутизатор имеет **loopback**-интерфейс вида:

**10.xxx.255.RR/32**

Каждый коммутатор имеет **loopback**-интерфейс вида:

**10.xxx.254.SS/32**

Где RR — номер маршрутизатора.
    SS - номер коммутатора

Примеры:

- **R12 → 10.100.255.12/32**
- **R13 → 10.100.255.13/32** 
- **R21 → 10.103.255.21/32**
- **R23 → 10.52.255.23/32**

Назначение:

- стабильные идентификаторы для **IGP (OSPF/ISIS)**
- опорные точки для **BGP Router-ID**
- точка для управляющих протоколов (**VRRP, SLA, NetFlow** и т. д.)

**Loopback-адреса** уникальны в масштабе всей топологии и никогда не меняются.

## **5. Адресация пользовательских VLAN**

В сети присутствуют VLAN 10, 20, 102 и др. Адресация построена по принципу:

``10.<region>.<vlan>.<device>``

---
## VLAN 10, 20 присутсвтуют в трез зонах:

- Valhalla
- Helheim
- Midgard

``Адресация соответсвтует блокам ip адерсов в зоне.``

### Valhalla

- VLAN 10 (10.100.10.0/24
- VLAN 20 (10.100.20.0/24



Используется на R12, R13:

- **R12 → 10.100.10.2** (суб интерфейс - e0/0.10)
- **R13 → 10.100.10.3**
- **VRRP виртуальный шлюз → 10.100.10.1**

---

### **VLAN 20 (10.100.20.0/24)**

- **R12 → 10.100.20.2**
- **R13 → 10.100.20.3**
- **VRRP виртуальный шлюз → 10.100.20.1**

---

### **VLAN 102 (Management VLAN)**

На разных коммутаторах имеет вид:

- **SW2 → x.x.102.102**
- **SW3 → x.x.102.103**
- **SW4 → x.x.102.104**
- **SW5 → x.x.102.105**
- **SW9 → x.x.102.109**
- **SW10 → x.x.102.110**
- **SW29 → x.x.102.129**

VLAN 102 сделан для упрощения менеджмента.


<a name="part_2"><h2>Часть 2: Настроите ip адреса на каждом активном порту.</h2></a>

# Отчет по настройке интерфейсов сетевых устройств

Целью данной работы является базовая конфигурация сетевых интерфейсов на всех устройствах лабораторного стенда (маршрутизаторы и коммутаторы) с обеспечением корректной адресации, управления и связности между узлами сети.

## Общие принципы конфигурации
При настройке интерфейсов на всех устройствах были использованы следующие принципы:

- Каждый сетевой интерфейс имеет четко определённую роль (транзитный, пользовательский, управляющий).
- Управляющий доступ к устройствам реализован через отдельный L3-интерфейс с IP-адресом из сети управления.
- Неиспользуемые интерфейсы переведены в состояние *shutdown* (в первую очередь на маршрутизаторах).
- Для логической идентификации устройств используются loopback-интерфейсы.
- Адресация выполнена в соответствии с заранее разработанной схемой IP-адресов.

## Типовая схема интерфейсов
На большинстве устройств используется следующая логика:
- **Ethernet0/x** — интерфейсы для межсетевых соединений или VLAN-транков  
- **Ethernet1/3** — выделенный интерфейс управления (Management)  
- **Loopback1** — логический интерфейс для идентификации устройства  

## Пример конфигурации интерфейса (маршрутизатор)

Ниже приведён один пример конфигурации интерфейсов на маршрутизаторе:

```plaintext
interface Ethernet1/3
 ip address 192.168.102.115 255.255.255.0
 no shutdown

interface Loopback1
 ip address 10.100.255.15 255.255.255.255

